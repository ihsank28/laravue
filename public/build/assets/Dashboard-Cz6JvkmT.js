import{o as b,g as y,b as h,k as Ve,l as te,m as We,j as Xe,p as qe,C as Ge,q as le,h as P,f as N,a as C,u as R,w as ne,e as Ce,t as Ke,n as Ye,F as Se,s as Ze,x as ce,G as Je,d as Qe}from"./app-BhEQy_S5.js";import{_ as et}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as de,a as tt,b as he}from"./TextInput-B6NJMSri.js";import{P as nt}from"./PrimaryButton-CWclFTL_.js";import{_ as rt}from"./AuthenticatedLayout-C_fzadLc.js";import"./ApplicationLogo-BiY9Dl4-.js";const st={},it={class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true"};function at(e,t){return b(),y("svg",it,t[0]||(t[0]=[h("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const ot=et(st,[["render",at]]),ut={__name:"TextArea",props:{modelValue:{type:String,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(e,{expose:t}){const n=Ve(e,"modelValue"),r=te(null);return We(()=>{r.value.hasAttribute("autofocus")&&r.value.focus()}),t({focus:()=>r.value.focus()}),(s,u)=>Xe((b(),y("textarea",{class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm","onUpdate:modelValue":u[0]||(u[0]=l=>n.value=l),ref_key:"input",ref:r},null,512)),[[qe,n.value]])}},lt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ct={class:"p-6 border-gray-900"},dt={class:"flex space-x-6"},ht={class:"max-w-[240px] w-full space-y-3"},ft={key:0,class:"space-y-1"},pt={class:"bg-gray-100 shadow-inner h-3 rounded overflow-hidden"},mt={key:1,class:"space-y-1"},gt={class:"bg-gray-100 shadow-inner h-3 rounded overflow-hidden"},vt={key:2,class:"flex items-center space-x-3"},bt={class:"flex items-center space-x-3"},yt={key:0,class:"text-sm"},kt={__name:"UploadItem",props:{upload:Object},setup(e,{emit:t}){const n=t,r=e,s=Ge({title:r.upload.title,description:""}),u=()=>{s.put(route("videos.update",r.upload.id),{preserveScroll:!0,preserveState:!0})};return(l,i)=>(b(),y("div",lt,[h("div",ct,[h("div",dt,[h("div",ht,[e.upload.uploading?(b(),y("div",ft,[h("div",pt,[h("div",{class:"h-full bg-indigo-600 rounded-full",style:le({width:`${e.upload.progress}%`})},null,4)]),i[5]||(i[5]=h("div",{class:"text-sm"},"Uploading",-1))])):P("",!0),e.upload.encoding?(b(),y("div",mt,[h("div",gt,[h("div",{class:"bg-green-500 h-full rounded-full",style:le({width:`${e.upload.encodingProgress}%`})},null,4)]),i[6]||(i[6]=h("div",{class:"text-sm"},"Encoding",-1))])):P("",!0),e.upload.uploading?(b(),y("div",vt,[e.upload.file.paused?P("",!0):(b(),y("button",{key:0,onClick:i[0]||(i[0]=a=>n("pause",e.upload.id)),class:"text-blue-500 text-sm font-medium"}," Pause ")),e.upload.file.paused?(b(),y("button",{key:1,onClick:i[1]||(i[1]=a=>n("resume",e.upload.id)),class:"text-blue-500 text-sm font-medium"}," Resume ")):P("",!0),e.upload.uploading?(b(),y("button",{key:2,onClick:i[2]||(i[2]=a=>n("cancel",e.upload.id)),class:"text-blue-500 text-sm font-medium"}," Cancel upload ")):P("",!0)])):P("",!0)]),h("form",{onSubmit:N(u,["prevent"]),class:"flex-grow space-y-6"},[h("div",null,[C(de,{for:"title",value:"Title"}),C(tt,{modelValue:R(s).title,"onUpdate:modelValue":i[3]||(i[3]=a=>R(s).title=a),id:"title",type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),C(he,{message:R(s).errors.title},null,8,["message"])]),h("div",null,[C(de,{for:"description",value:"Description"}),C(ut,{modelValue:R(s).description,"onUpdate:modelValue":i[4]||(i[4]=a=>R(s).description=a),id:"description",class:"mt-1 block w-full"},null,8,["modelValue"]),C(he,{message:R(s).errors.description},null,8,["message"])]),h("div",bt,[C(nt,null,{default:ne(()=>i[7]||(i[7]=[Ce(" Save ")])),_:1}),R(s).recentlySuccessful?(b(),y("div",yt," Video updated ")):P("",!0)])],32)])])]))}};var Ct=Object.create,we=Object.defineProperty,St=Object.getOwnPropertyDescriptor,Ee=Object.getOwnPropertyNames,wt=Object.getPrototypeOf,Et=Object.prototype.hasOwnProperty,L=(e,t)=>function(){return t||(0,e[Ee(e)[0]])((t={exports:{}}).exports,t),t.exports},_t=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Ee(t))!Et.call(e,s)&&s!==n&&we(e,s,{get:()=>t[s],enumerable:!(r=St(t,s))||r.enumerable});return e},Rt=(e,t,n)=>(n=e!=null?Ct(wt(e)):{},_t(!e||!e.__esModule?we(n,"default",{value:e,enumerable:!0}):n,e)),zt=L({"node_modules/global/window.js"(e,t){var n;typeof window<"u"?n=window:typeof global<"u"?n=global:typeof self<"u"?n=self:n={},t.exports=n}}),xt=L({"node_modules/is-function/index.js"(e,t){t.exports=r;var n=Object.prototype.toString;function r(s){if(!s)return!1;var u=n.call(s);return u==="[object Function]"||typeof s=="function"&&u!=="[object RegExp]"||typeof window<"u"&&(s===window.setTimeout||s===window.alert||s===window.confirm||s===window.prompt)}}}),Tt=L({"node_modules/parse-headers/parse-headers.js"(e,t){var n=function(s){return s.replace(/^\s+|\s+$/g,"")},r=function(s){return Object.prototype.toString.call(s)==="[object Array]"};t.exports=function(s){if(!s)return{};for(var u={},l=n(s).split(`
`),i=0;i<l.length;i++){var a=l[i],c=a.indexOf(":"),f=n(a.slice(0,c)).toLowerCase(),k=n(a.slice(c+1));typeof u[f]>"u"?u[f]=k:r(u[f])?u[f].push(k):u[f]=[u[f],k]}return u}}}),Pt=L({"node_modules/xtend/immutable.js"(e,t){t.exports=r;var n=Object.prototype.hasOwnProperty;function r(){for(var s={},u=0;u<arguments.length;u++){var l=arguments[u];for(var i in l)n.call(l,i)&&(s[i]=l[i])}return s}}}),Ot=L({"node_modules/xhr/index.js"(e,t){var n=zt(),r=xt(),s=Tt(),u=Pt();t.exports=c,t.exports.default=c,c.XMLHttpRequest=n.XMLHttpRequest||W,c.XDomainRequest="withCredentials"in new c.XMLHttpRequest?c.XMLHttpRequest:n.XDomainRequest,l(["get","put","post","patch","head","delete"],function(o){c[o==="delete"?"del":o]=function(g,v,_){return v=a(g,v,_),v.method=o.toUpperCase(),f(v)}});function l(o,g){for(var v=0;v<o.length;v++)g(o[v])}function i(o){for(var g in o)if(o.hasOwnProperty(g))return!1;return!0}function a(o,g,v){var _=o;return r(g)?(v=g,typeof o=="string"&&(_={uri:o})):_=u(g,{uri:o}),_.callback=v,_}function c(o,g,v){return g=a(o,g,v),f(g)}function f(o){if(typeof o.callback>"u")throw new Error("callback argument missing");var g=!1,v=function(T,F,He){g||(g=!0,o.callback(T,F,He))};function _(){d.readyState===4&&setTimeout(ae,0)}function $e(){var p=void 0;if(d.response?p=d.response:p=d.responseText||k(d),oe)try{p=JSON.parse(p)}catch{}return p}function X(p){return clearTimeout(Y),p instanceof Error||(p=new Error(""+(p||"Unknown XMLHttpRequest Error"))),p.statusCode=0,v(p,ue)}function ae(){if(!M){var p;clearTimeout(Y),o.useXDR&&d.status===void 0?p=200:p=d.status===1223?204:d.status;var T=ue,F=null;return p!==0?(T={body:$e(),statusCode:p,method:I,headers:{},url:q,rawRequest:d},d.getAllResponseHeaders&&(T.headers=s(d.getAllResponseHeaders()))):F=new Error("Internal XMLHttpRequest Error"),v(F,T,T.body)}}var d=o.xhr||null;d||(o.cors||o.useXDR?d=new c.XDomainRequest:d=new c.XMLHttpRequest);var j,M,q=d.url=o.uri||o.url,I=d.method=o.method||"GET",G=o.body||o.data,w=d.headers=o.headers||{},K=!!o.sync,oe=!1,Y,ue={body:void 0,headers:{},statusCode:0,method:I,url:q,rawRequest:d};if("json"in o&&o.json!==!1&&(oe=!0,w.accept||w.Accept||(w.Accept="application/json"),I!=="GET"&&I!=="HEAD"&&(w["content-type"]||w["Content-Type"]||(w["Content-Type"]="application/json"),G=JSON.stringify(o.json===!0?G:o.json))),d.onreadystatechange=_,d.onload=ae,d.onerror=X,d.onprogress=function(){},d.onabort=function(){M=!0},d.ontimeout=X,d.open(I,q,!K,o.username,o.password),K||(d.withCredentials=!!o.withCredentials),!K&&o.timeout>0&&(Y=setTimeout(function(){if(!M){M=!0,d.abort("timeout");var p=new Error("XMLHttpRequest timeout");p.code="ETIMEDOUT",X(p)}},o.timeout)),d.setRequestHeader)for(j in w)w.hasOwnProperty(j)&&d.setRequestHeader(j,w[j]);else if(o.headers&&!i(o.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in o&&(d.responseType=o.responseType),"beforeSend"in o&&typeof o.beforeSend=="function"&&o.beforeSend(d),d.send(G||null),d}function k(o){try{if(o.responseType==="document")return o.responseXML;var g=o.responseXML&&o.responseXML.documentElement.nodeName==="parsererror";if(o.responseType===""&&!g)return o.responseXML}catch{}return null}function W(){}}});function se(e,t,...n){if(!e)throw new TypeError(_e(t,n))}function _e(e,t){let n=0;return e.replace(/%[os]/gu,()=>Re(t[n++]))}function Re(e){return typeof e!="object"||e===null?String(e):Object.prototype.toString.call(e)}var It;function At(e){try{const t=e instanceof Error?e:new Error(Re(e));if(typeof dispatchEvent=="function"&&typeof ErrorEvent=="function")dispatchEvent(new ErrorEvent("error",{error:t,message:t.message}));else if(typeof process<"u"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)}catch{}}var S=typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:typeof globalThis<"u"?globalThis:void 0,Bt,x=class{constructor(e,t){this.code=e,this.message=t}warn(...e){var t;try{const n=((t=new Error().stack)!==null&&t!==void 0?t:"").replace(/^(?:.+?\n){2}/gu,`
`);console.warn(this.message,...e,n)}catch{}}},Lt=new x("W01","Unable to initialize event under dispatching."),Dt=new x("W02","Assigning any falsy value to 'cancelBubble' property has no effect."),Ut=new x("W03","Assigning any truthy value to 'returnValue' property has no effect."),jt=new x("W04","Unable to preventDefault on non-cancelable events."),Mt=new x("W05","Unable to preventDefault inside passive event listener invocation."),Ft=new x("W06","An event listener wasn't added because it has been added already: %o, %o"),Z=new x("W07","The %o option value was abandoned because the event listener wasn't added as duplicated."),fe=new x("W08","The 'callback' argument must be a function or an object that has 'handleEvent' method: %o"),E=class{static get NONE(){return pe}static get CAPTURING_PHASE(){return me}static get AT_TARGET(){return ge}static get BUBBLING_PHASE(){return ve}constructor(e,t){Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=t??{};re.set(this,{type:String(e),bubbles:!!n.bubbles,cancelable:!!n.cancelable,composed:!!n.composed,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1,inPassiveListenerFlag:!1,dispatchFlag:!1,timeStamp:Date.now()})}get type(){return m(this).type}get target(){return m(this).target}get srcElement(){return m(this).target}get currentTarget(){return m(this).currentTarget}composedPath(){const e=m(this).currentTarget;return e?[e]:[]}get NONE(){return pe}get CAPTURING_PHASE(){return me}get AT_TARGET(){return ge}get BUBBLING_PHASE(){return ve}get eventPhase(){return m(this).dispatchFlag?2:0}stopPropagation(){m(this).stopPropagationFlag=!0}get cancelBubble(){return m(this).stopPropagationFlag}set cancelBubble(e){e?m(this).stopPropagationFlag=!0:Dt.warn()}stopImmediatePropagation(){const e=m(this);e.stopPropagationFlag=e.stopImmediatePropagationFlag=!0}get bubbles(){return m(this).bubbles}get cancelable(){return m(this).cancelable}get returnValue(){return!m(this).canceledFlag}set returnValue(e){e?Ut.warn():be(m(this))}preventDefault(){be(m(this))}get defaultPrevented(){return m(this).canceledFlag}get composed(){return m(this).composed}get isTrusted(){return!1}get timeStamp(){return m(this).timeStamp}initEvent(e,t=!1,n=!1){const r=m(this);if(r.dispatchFlag){Lt.warn();return}re.set(this,{...r,type:String(e),bubbles:!!t,cancelable:!!n,target:null,currentTarget:null,stopPropagationFlag:!1,stopImmediatePropagationFlag:!1,canceledFlag:!1})}},pe=0,me=1,ge=2,ve=3,re=new WeakMap;function m(e,t="this"){const n=re.get(e);return se(n!=null,"'%s' must be an object that Event constructor created, but got another one: %o",t,e),n}function be(e){if(e.inPassiveListenerFlag){Mt.warn();return}if(!e.cancelable){jt.warn();return}e.canceledFlag=!0}Object.defineProperty(E,"NONE",{enumerable:!0});Object.defineProperty(E,"CAPTURING_PHASE",{enumerable:!0});Object.defineProperty(E,"AT_TARGET",{enumerable:!0});Object.defineProperty(E,"BUBBLING_PHASE",{enumerable:!0});var J=Object.getOwnPropertyNames(E.prototype);for(let e=0;e<J.length;++e)J[e]!=="constructor"&&Object.defineProperty(E.prototype,J[e],{enumerable:!0});typeof S<"u"&&typeof S.Event<"u"&&Object.setPrototypeOf(E.prototype,S.Event.prototype);function Nt(e){return S.DOMException?new S.DOMException(e,"InvalidStateError"):(O==null&&(O=class ze extends Error{constructor(n){super(n),Error.captureStackTrace&&Error.captureStackTrace(this,ze)}get code(){return 11}get name(){return"InvalidStateError"}},Object.defineProperties(O.prototype,{code:{enumerable:!0},name:{enumerable:!0}}),ke(O),ke(O.prototype)),new O(e))}var O,ye={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function ke(e){const t=Object.keys(ye);for(let n=0;n<t.length;++n){const r=t[n],s=ye[r];Object.defineProperty(e,r,{get(){return s},configurable:!0,enumerable:!0})}}var H=class extends E{static wrap(e){return new(Te(e))(e)}constructor(e){super(e.type,{bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed}),e.cancelBubble&&super.stopPropagation(),e.defaultPrevented&&super.preventDefault(),xe.set(this,{original:e});const t=Object.keys(e);for(let n=0;n<t.length;++n){const r=t[n];r in this||Object.defineProperty(this,r,Pe(e,r))}}stopPropagation(){super.stopPropagation();const{original:e}=z(this);"stopPropagation"in e&&e.stopPropagation()}get cancelBubble(){return super.cancelBubble}set cancelBubble(e){super.cancelBubble=e;const{original:t}=z(this);"cancelBubble"in t&&(t.cancelBubble=e)}stopImmediatePropagation(){super.stopImmediatePropagation();const{original:e}=z(this);"stopImmediatePropagation"in e&&e.stopImmediatePropagation()}get returnValue(){return super.returnValue}set returnValue(e){super.returnValue=e;const{original:t}=z(this);"returnValue"in t&&(t.returnValue=e)}preventDefault(){super.preventDefault();const{original:e}=z(this);"preventDefault"in e&&e.preventDefault()}get timeStamp(){const{original:e}=z(this);return"timeStamp"in e?e.timeStamp:super.timeStamp}},xe=new WeakMap;function z(e){const t=xe.get(e);return se(t!=null,"'this' is expected an Event object, but got",e),t}var $=new WeakMap;$.set(Object.prototype,H);typeof S<"u"&&typeof S.Event<"u"&&$.set(S.Event.prototype,H);function Te(e){const t=Object.getPrototypeOf(e);if(t==null)return H;let n=$.get(t);return n==null&&(n=$t(Te(t),t),$.set(t,n)),n}function $t(e,t){class n extends e{}const r=Object.keys(t);for(let s=0;s<r.length;++s)Object.defineProperty(n.prototype,r[s],Pe(t,r[s]));return n}function Pe(e,t){const n=Object.getOwnPropertyDescriptor(e,t);return{get(){const r=z(this).original,s=r[t];return typeof s=="function"?s.bind(r):s},set(r){const s=z(this).original;s[t]=r},configurable:n.configurable,enumerable:n.enumerable}}function Ht(e,t,n,r,s,u){return{callback:e,flags:(t?1:0)|(n?2:0)|(r?4:0),signal:s,signalListener:u}}function Vt(e){e.flags|=8}function Oe(e){return(e.flags&1)===1}function Ie(e){return(e.flags&2)===2}function Ae(e){return(e.flags&4)===4}function Wt(e){return(e.flags&8)===8}function Xt({callback:e},t,n){try{typeof e=="function"?e.call(t,n):typeof e.handleEvent=="function"&&e.handleEvent(n)}catch(r){At(r)}}function Be({listeners:e},t,n){for(let r=0;r<e.length;++r)if(e[r].callback===t&&Oe(e[r])===n)return r;return-1}function qt(e,t,n,r,s,u){let l;u&&(l=Le.bind(null,e,t,n),u.addEventListener("abort",l));const i=Ht(t,n,r,s,u,l);return e.cow?(e.cow=!1,e.listeners=[...e.listeners,i]):e.listeners.push(i),i}function Le(e,t,n){const r=Be(e,t,n);return r!==-1?De(e,r):!1}function De(e,t,n=!1){const r=e.listeners[t];return Vt(r),r.signal&&r.signal.removeEventListener("abort",r.signalListener),e.cow&&!n?(e.cow=!1,e.listeners=e.listeners.filter((s,u)=>u!==t),!1):(e.listeners.splice(t,1),!0)}function Gt(){return Object.create(null)}function Kt(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t]={attrCallback:void 0,attrListener:void 0,cow:!1,listeners:[]}}var V=class{constructor(){Ue.set(this,Gt())}addEventListener(e,t,n){const r=Q(this),{callback:s,capture:u,once:l,passive:i,signal:a,type:c}=Yt(e,t,n);if(s==null||a!=null&&a.aborted)return;const f=Kt(r,c),k=Be(f,s,u);if(k!==-1){Jt(f.listeners[k],i,l,a);return}qt(f,s,u,i,l,a)}removeEventListener(e,t,n){const r=Q(this),{callback:s,capture:u,type:l}=Zt(e,t,n),i=r[l];s!=null&&i&&Le(i,s,u)}dispatchEvent(e){const t=Q(this)[String(e.type)];if(t==null)return!0;const n=e instanceof E?e:H.wrap(e),r=m(n,"event");if(r.dispatchFlag)throw Nt("This event has been in dispatching.");if(r.dispatchFlag=!0,r.target=r.currentTarget=this,!r.stopPropagationFlag){const{cow:s,listeners:u}=t;t.cow=!0;for(let l=0;l<u.length;++l){const i=u[l];if(!Wt(i)&&(Ae(i)&&De(t,l,!s)&&(l-=1),r.inPassiveListenerFlag=Ie(i),Xt(i,this,n),r.inPassiveListenerFlag=!1,r.stopImmediatePropagationFlag))break}s||(t.cow=!1)}return r.target=null,r.currentTarget=null,r.stopImmediatePropagationFlag=!1,r.stopPropagationFlag=!1,r.dispatchFlag=!1,!r.canceledFlag}},Ue=new WeakMap;function Q(e,t="this"){const n=Ue.get(e);return se(n!=null,"'%s' must be an object that EventTarget constructor created, but got another one: %o",t,e),n}function Yt(e,t,n){var r;return je(t),typeof n=="object"&&n!==null?{type:String(e),callback:t??void 0,capture:!!n.capture,passive:!!n.passive,once:!!n.once,signal:(r=n.signal)!==null&&r!==void 0?r:void 0}:{type:String(e),callback:t??void 0,capture:!!n,passive:!1,once:!1,signal:void 0}}function Zt(e,t,n){return je(t),typeof n=="object"&&n!==null?{type:String(e),callback:t??void 0,capture:!!n.capture}:{type:String(e),callback:t??void 0,capture:!!n}}function je(e){if(!(typeof e=="function"||typeof e=="object"&&e!==null&&typeof e.handleEvent=="function")){if(e==null||typeof e=="object"){fe.warn(e);return}throw new TypeError(_e(fe.message,[e]))}}function Jt(e,t,n,r){Ft.warn(Oe(e)?"capture":"bubble",e.callback),Ie(e)!==t&&Z.warn("passive"),Ae(e)!==n&&Z.warn("once"),e.signal!==r&&Z.warn("signal")}var ee=Object.getOwnPropertyNames(V.prototype);for(let e=0;e<ee.length;++e)ee[e]!=="constructor"&&Object.defineProperty(V.prototype,ee[e],{enumerable:!0});typeof S<"u"&&typeof S.EventTarget<"u"&&Object.setPrototypeOf(V.prototype,S.EventTarget.prototype);var Qt=Rt(Ot()),ie=30720,D=512e3,U=256,A=(e,{minChunkSize:t=U,maxChunkSize:n=D}={})=>e==null||typeof e=="number"&&e>=256&&e%256===0&&e>=t&&e<=n,B=(e,{minChunkSize:t=U,maxChunkSize:n=D}={})=>new TypeError(`chunkSize ${e} must be a positive number in multiples of 256, between ${t} and ${n}`),en=class{constructor(e,t={}){this.readableStream=e;var n,r,s;if(!A(t.defaultChunkSize,t))throw B(t.defaultChunkSize,t);this.defaultChunkSize=(n=t.defaultChunkSize)!=null?n:ie,this.minChunkSize=(r=t.minChunkSize)!=null?r:U,this.maxChunkSize=(s=t.maxChunkSize)!=null?s:D}get chunkSize(){var e;return(e=this._chunkSize)!=null?e:this.defaultChunkSize}set chunkSize(e){if(!A(e,this))throw B(e,this);this._chunkSize=e}get chunkByteSize(){return this.chunkSize*1024}get error(){return this._error}async*[Symbol.asyncIterator](){let e;const t=this.readableStream.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n){if(e){const u=e;e=void 0,yield u}break}const s=r instanceof Uint8Array?new Blob([r],{type:"application/octet-stream"}):r;for(e=e?new Blob([e,s]):s;e;)if(e.size===this.chunkByteSize){const u=e;e=void 0,yield u;break}else{if(e.size<this.chunkByteSize)break;{const u=e.slice(0,this.chunkByteSize);e=e.slice(this.chunkByteSize),yield u}}}}catch(n){this._error=n}finally{if(e){const n=e;e=void 0,yield n}t.releaseLock();return}}},tn=class{constructor(e,t={}){this.file=e;var n,r,s;if(!A(t.defaultChunkSize,t))throw B(t.defaultChunkSize,t);this.defaultChunkSize=(n=t.defaultChunkSize)!=null?n:ie,this.minChunkSize=(r=t.minChunkSize)!=null?r:U,this.maxChunkSize=(s=t.maxChunkSize)!=null?s:D}get chunkSize(){var e;return(e=this._chunkSize)!=null?e:this.defaultChunkSize}set chunkSize(e){if(!A(e,this))throw B(e,this);this._chunkSize=e}get chunkByteSize(){return this.chunkSize*1024}get error(){return this._error}async*[Symbol.asyncIterator](){const e=new FileReader;let t=0;const n=()=>new Promise(r=>{if(t>=this.file.size){r(void 0);return}const s=Math.min(this.chunkByteSize,this.file.size-t);e.onload=()=>{e.result!==null?r(new Blob([e.result],{type:"application/octet-stream"})):r(void 0)},e.readAsArrayBuffer(this.file.slice(t,t+s))});try{for(;;){const r=await n();if(r)t+=r.size,yield r;else break}}catch(r){this._error=r}}},nn=[200,201,202,204,308],Me=[408,502,503,504],rn=[308],Fe=(e,t)=>!!e&&nn.includes(e.statusCode),sn=(e,{retryCodes:t=Me})=>!e||t.includes(e.statusCode),an=(e,t)=>t.attemptCount>=t.attempts||!(Fe(e)||sn(e,t)),on=(e,t)=>{var n;if(!e||!rn.includes(e.statusCode)||!((n=e.headers)!=null&&n.range))return!1;const r=e.headers.range.match(/bytes=(\d+)-(\d+)/);return r?parseInt(r[2],10)!==t.currentChunkEndByte:!1},Ne=class{static createUpload(e){return new Ne(e)}constructor(e){if(this.eventTarget=new V,this.endpoint=e.endpoint,this.file=e.file,this.headers=e.headers||{},this.method=e.method||"PUT",this.attempts=e.attempts||5,this.delayBeforeAttempt=e.delayBeforeAttempt||1,this.retryCodes=e.retryCodes||Me,this.dynamicChunkSize=e.dynamicChunkSize||!1,this.maxFileBytes=(e.maxFileSize||0)*1024,this.chunkCount=0,this.attemptCount=0,this._offline=typeof window<"u"&&!window.navigator.onLine,this._paused=!1,this.success=!1,this.nextChunkRangeStart=0,e.useLargeFileWorkaround){const t=n=>{this.chunkedIterable.error&&(console.warn(`Unable to read file of size ${this.file.size} bytes via a ReadableStream. Falling back to in-memory FileReader!`),n.stopImmediatePropagation(),this.chunkedIterable=new tn(this.file,{...e,defaultChunkSize:e.chunkSize}),this.chunkedIterator=this.chunkedIterable[Symbol.asyncIterator](),this.getEndpoint().then(()=>{this.sendChunks()}),this.off("error",t))};this.on("error",t)}this.chunkedIterable=new en(this.file.stream(),{...e,defaultChunkSize:e.chunkSize}),this.chunkedIterator=this.chunkedIterable[Symbol.asyncIterator](),this.totalChunks=Math.ceil(this.file.size/this.chunkByteSize),this.validateOptions(),this.getEndpoint().then(()=>this.sendChunks()),typeof window<"u"&&(window.addEventListener("online",()=>{this.offline&&(this._offline=!1,this.dispatch("online"),this.sendChunks())}),window.addEventListener("offline",()=>{this.offline||(this._offline=!0,this.dispatch("offline"))}))}get maxChunkSize(){var e,t;return(t=(e=this.chunkedIterable)==null?void 0:e.maxChunkSize)!=null?t:D}get minChunkSize(){var e,t;return(t=(e=this.chunkedIterable)==null?void 0:e.minChunkSize)!=null?t:U}get chunkSize(){var e,t;return(t=(e=this.chunkedIterable)==null?void 0:e.chunkSize)!=null?t:ie}set chunkSize(e){this.chunkedIterable.chunkSize=e}get chunkByteSize(){return this.chunkedIterable.chunkByteSize}get totalChunkSize(){return Math.ceil(this.file.size/this.chunkByteSize)}on(e,t){this.eventTarget.addEventListener(e,t)}once(e,t){this.eventTarget.addEventListener(e,t,{once:!0})}off(e,t){this.eventTarget.removeEventListener(e,t)}get offline(){return this._offline}get paused(){return this._paused}abort(){var e;this.pause(),(e=this.currentXhr)==null||e.abort()}pause(){this._paused=!0}resume(){this._paused&&(this._paused=!1,this.sendChunks())}get successfulPercentage(){return this.nextChunkRangeStart/this.file.size}dispatch(e,t){const n=new CustomEvent(e,{detail:t});this.eventTarget.dispatchEvent(n)}validateOptions(){if(!this.endpoint||typeof this.endpoint!="function"&&typeof this.endpoint!="string")throw new TypeError("endpoint must be defined as a string or a function that returns a promise");if(!(this.file instanceof File))throw new TypeError("file must be a File object");if(this.headers&&typeof this.headers!="function"&&typeof this.headers!="object")throw new TypeError("headers must be null, an object, or a function that returns an object or a promise");if(!A(this.chunkSize,{maxChunkSize:this.maxChunkSize,minChunkSize:this.minChunkSize}))throw B(this.chunkSize,{maxChunkSize:this.maxChunkSize,minChunkSize:this.minChunkSize});if(this.maxChunkSize&&(typeof this.maxChunkSize!="number"||this.maxChunkSize<256||this.maxChunkSize%256!==0||this.maxChunkSize<this.chunkSize||this.maxChunkSize<this.minChunkSize))throw new TypeError(`maxChunkSize must be a positive number in multiples of 256, and larger than or equal to both ${this.minChunkSize} and ${this.chunkSize}`);if(this.minChunkSize&&(typeof this.minChunkSize!="number"||this.minChunkSize<256||this.minChunkSize%256!==0||this.minChunkSize>this.chunkSize||this.minChunkSize>this.maxChunkSize))throw new TypeError(`minChunkSize must be a positive number in multiples of 256, and smaller than ${this.chunkSize} and ${this.maxChunkSize}`);if(this.maxFileBytes>0&&this.maxFileBytes<this.file.size)throw new Error(`file size exceeds maximum (${this.file.size} > ${this.maxFileBytes})`);if(this.attempts&&(typeof this.attempts!="number"||this.attempts<=0))throw new TypeError("retries must be a positive number");if(this.delayBeforeAttempt&&(typeof this.delayBeforeAttempt!="number"||this.delayBeforeAttempt<0))throw new TypeError("delayBeforeAttempt must be a positive number")}getEndpoint(){return typeof this.endpoint=="string"?(this.endpointValue=this.endpoint,Promise.resolve(this.endpoint)):this.endpoint(this.file).then(e=>(this.endpointValue=e,this.endpointValue))}xhrPromise(e){const t=n=>{n.upload.onprogress=r=>{var s;const u=this.totalChunks-this.chunkCount,l=(this.file.size-this.nextChunkRangeStart)/this.file.size/u,a=r.loaded/((s=r.total)!=null?s:this.chunkByteSize)*l;this.dispatch("progress",Math.min((this.successfulPercentage+a)*100,100))}};return new Promise((n,r)=>{this.currentXhr=(0,Qt.default)({...e,beforeSend:t},(s,u)=>(this.currentXhr=void 0,s?r(s):n(u)))})}async sendChunk(e){const t=this.nextChunkRangeStart,n=t+e.size-1,s={...await(typeof this.headers=="function"?this.headers():this.headers),"Content-Type":this.file.type,"Content-Range":`bytes ${t}-${n}/${this.file.size}`};return this.dispatch("attempt",{chunkNumber:this.chunkCount,totalChunks:this.totalChunks,chunkSize:this.chunkSize}),this.xhrPromise({headers:s,url:this.endpointValue,method:this.method,body:e})}async sendChunkWithRetries(e){const t=async(l,i)=>{var a;const f=(new Date().getTime()-this.lastChunkStart.getTime())/1e3;if(this.dispatch("chunkSuccess",{chunk:this.chunkCount,chunkSize:this.chunkSize,attempts:this.attemptCount,timeInterval:f,response:l}),this.attemptCount=0,this.chunkCount=((a=this.chunkCount)!=null?a:0)+1,this.nextChunkRangeStart=this.nextChunkRangeStart+this.chunkByteSize,this.dynamicChunkSize){let k=this.chunkSize;f<10?k=Math.min(this.chunkSize*2,this.maxChunkSize):f>30&&(k=Math.max(this.chunkSize/2,this.minChunkSize)),this.chunkSize=Math.ceil(k/256)*256;const W=(this.file.size-this.nextChunkRangeStart)/this.chunkByteSize;this.totalChunks=Math.ceil(this.chunkCount+W)}return!0},n=async(l,i)=>(this.dispatch("progress",Math.min(this.successfulPercentage*100,100)),this.dispatch("error",{message:`Server responded with ${l.statusCode}. Stopping upload.`,chunk:this.chunkCount,attempts:this.attemptCount,response:l}),!1),r=async(l,i)=>(this.dispatch("attemptFailure",{message:`An error occured uploading chunk ${this.chunkCount}. ${this.attempts-this.attemptCount} retries left.`,chunkNumber:this.chunkCount,attemptsLeft:this.attempts-this.attemptCount,response:l}),new Promise(a=>{setTimeout(async()=>{if(this._paused||this.offline){this.pendingChunk=e,a(!1);return}const c=await this.sendChunkWithRetries(e);a(c)},this.delayBeforeAttempt*1e3)}));let s;try{this.attemptCount=this.attemptCount+1,this.lastChunkStart=new Date,s=await this.sendChunk(e)}catch(l){typeof(l==null?void 0:l.statusCode)=="number"&&(s=l)}const u={retryCodes:this.retryCodes,attemptCount:this.attemptCount,attempts:this.attempts,currentChunkEndByte:this.nextChunkRangeStart+e.size-1};return on(s,u)?r(s):Fe(s)?t(s):an(s,u)?n(s):r(s)}async sendChunks(){if(this.pendingChunk&&!(this._paused||this.offline)){const e=this.pendingChunk;this.pendingChunk=void 0;const t=await this.sendChunkWithRetries(e);this.success&&t&&this.dispatch("success")}for(;!(this.success||this._paused||this.offline);){const{value:e,done:t}=await this.chunkedIterator.next();let n=!e&&t;if(e&&(n=await this.sendChunkWithRetries(e)),this.chunkedIterable.error){n=!1,this.dispatch("error",{message:`Unable to read file of size ${this.file.size} bytes. Try loading from another browser.`});return}if(this.success=!!t,this.success&&n&&this.dispatch("success"),!n)return}}};function un(e){return Ne.createUpload(e)}const ln={class:"py-12"},cn={class:"max-w-3xl mx-auto sm:px-6 lg:px-8"},dn={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},hn={class:"p-6 bg-white border-b border-gray-200"},fn={class:"space-y-1 text-center"},pn={class:"flex text-sm text-gray-600"},mn={for:"file-upload",class:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"},gn={__name:"Uploader",setup(e){const t=te([]),n=te(!1),r=i=>{Array.from(i).forEach(a=>{ce.post(route("videos.store"),{title:a.name}).then(c=>{t.value.unshift({id:c.data.id,title:a.name,file:l(a,c.data.id),uploading:!0,progress:0})})})},s=i=>t.value.find(a=>a.id===i),u=i=>{s(i).file.abort(),Je.delete(route("videos.destroy",i),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{t.value=t.value.filter(a=>a.id!==i)}})},l=(i,a)=>{const c=un({endpoint:route("videos.upload",a),headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},method:"POST",file:i,chunkSize:262144});return c.on("error",f=>{console.error("Error:",f)}),c.on("progress",f=>{s(a).progress=f.detail}),c.on("success",f=>{s(a).uploading=!1,s(a).encoding=!0,ce.post(route("videos.process",a)).then(k=>{s(a).encoding=!1})}),c};return(i,a)=>(b(),y("div",ln,[h("div",cn,[h("div",dn,[h("div",hn,[Ce(Ke(n.value)+" ",1),h("div",{onDragover:a[1]||(a[1]=N(c=>n.value=!0,["prevent"])),onDragleave:a[2]||(a[2]=N(c=>n.value=!1,["prevent"])),onDrop:a[3]||(a[3]=N(c=>{r(c.dataTransfer.files),n.value=!1},["prevent"])),class:Ye(["mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-md border-gray-300",{"border-indigo-600":n.value}])},[h("div",fn,[C(ot),h("div",pn,[h("label",mn,[a[4]||(a[4]=h("span",null,"Upload a file",-1)),h("input",{onChange:a[0]||(a[0]=c=>r(c.target.files)),id:"file-upload",name:"file-upload",type:"file",class:"sr-only",multiple:""},null,32)]),a[5]||(a[5]=h("p",{class:"pl-1"},"or drag and drop",-1))]),a[6]||(a[6]=h("p",{class:"text-xs text-gray-500"}," MP4, AVI up to 100MB ",-1))])],34)])]),(b(!0),y(Se,null,Ze(t.value,c=>(b(),y("div",{class:"my-3",key:c.id},[C(kt,{onCancel:u,onResume:i.resumeUpload,onPause:i.pauseUpload,upload:c},null,8,["onResume","onPause","upload"])]))),128))])]))}},wn={__name:"Dashboard",setup(e){return(t,n)=>(b(),y(Se,null,[C(R(Qe),{title:"Dashboard"}),n[1]||(n[1]=h("meta",{name:"csrf-token",content:"{{ csrf_token() }}"},null,-1)),C(rt,null,{header:ne(()=>n[0]||(n[0]=[h("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Dashboard ",-1)])),default:ne(()=>[C(gn)]),_:1})],64))}};export{wn as default};
